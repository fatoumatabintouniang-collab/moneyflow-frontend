<div style="position: relative; min-height: 100vh; background: linear-gradient(90deg, #4779d7, #2569df); display: flex; justify-content: center; align-items: center;">

  <div class="card shadow-lg p-4"
       style="max-width: 600px; width: 90%; border-radius: 1.2rem;
              background: rgba(255,255,255,0.95); 
              transform: scale(0.95); 
              transition: transform 0.3s ease;">

    <!-- Header -->
    <div class="card-header text-center border-0" style="background: transparent;">
      <h2 class="mb-1">
        <i class="fas fa-coins" style="color:#4779d7;"></i> MoneyFlow
      </h2>
      <p class="text-muted">Créez votre compte et prenez le contrôle de vos finances</p>
    </div>

    <!-- Body -->
    <div class="card-body">
      <form (ngSubmit)="onRegister()" #registerForm="ngForm">

        <div class="row g-2 mb-2">
          <!-- Prénom -->
          <div class="col-md-6 col-12">
            <label for="firstName" class="form-label">Prénom *</label>
            <div class="input-group input-group-sm">
              <span class="input-group-text"><i class="fas fa-user" style="color:#4779d7;"></i></span>
              <input type="text" class="form-control" id="firstName" name="firstName"
                     [(ngModel)]="register.firstName" placeholder="Entrez votre prénom" required #firstName="ngModel">
            </div>
            <div *ngIf="firstName.invalid && firstName.touched" class="text-danger small">
              Le prénom est obligatoire
            </div>
          </div>

          <!-- Nom -->
          <div class="col-md-6 col-12">
            <label for="lastName" class="form-label">Nom *</label>
            <div class="input-group input-group-sm">
              <span class="input-group-text"><i class="fas fa-user" style="color:#4779d7;"></i></span>
              <input type="text" class="form-control" id="lastName" name="lastName"
                     [(ngModel)]="register.lastName" placeholder="Entrez votre nom" required #lastName="ngModel">
            </div>
            <div *ngIf="lastName.invalid && lastName.touched" class="text-danger small">
              Le nom est obligatoire
            </div>
          </div>
        </div>

        <!-- Username -->
        <div class="mb-2 mt-2">
          <label for="username" class="form-label">Nom d'utilisateur</label>
          <div class="input-group input-group-sm">
            <span class="input-group-text"><i class="fas fa-at" style="color:#4779d7;"></i></span>
            <input type="text" class="form-control" id="username" name="username"
                   [(ngModel)]="register.username" placeholder="Sera généré automatiquement si vide">
          </div>
          <small class="text-muted">Laissez vide pour génération automatique</small>
        </div>

        <!-- Email -->
        <div class="mb-2">
          <label for="email" class="form-label">Adresse email *</label>
          <div class="input-group input-group-sm">
            <span class="input-group-text"><i class="fas fa-envelope" style="color:#4779d7;"></i></span>
            <input type="email" class="form-control" id="email" name="email"
                   [(ngModel)]="register.email" placeholder="exemple@email.com" required email #email="ngModel">
          </div>
          <div *ngIf="email.invalid && email.touched" class="text-danger small">
            <span *ngIf="email.errors?.['required']">L'email est obligatoire</span>
            <span *ngIf="email.errors?.['email']">Format d'email invalide</span>
          </div>
        </div>

        <!-- Téléphone -->
        <div class="mb-2">
          <label for="phone" class="form-label">Numéro de téléphone *</label>
          <div class="input-group input-group-sm">
            <span class="input-group-text"><i class="fas fa-phone" style="color:#4779d7;"></i></span>
            <input type="tel" class="form-control" id="phone" name="phone"
                   [(ngModel)]="register.phone" (input)="onPhoneInput($event)"
                   placeholder="+221 77 123 45 67" required #phone="ngModel">
          </div>
          <div *ngIf="phone.invalid && phone.touched" class="text-danger small">
            Le numéro de téléphone est obligatoire
          </div>
        </div>

        <!-- Numéro d'identité -->
        <div class="mb-2">
          <label for="idNumber" class="form-label">Numéro d'identité</label>
          <div class="input-group input-group-sm">
            <span class="input-group-text"><i class="fas fa-id-card" style="color:#4779d7;"></i></span>
            <input type="text" class="form-control" id="idNumber" name="idNumber"
                   [(ngModel)]="register.idNumber" placeholder="Votre numéro CNI">
          </div>
        </div>

        <!-- Photo URL -->
        <div class="mb-2">
          <label for="photoUrl" class="form-label">Photo de profil (URL)</label>
          <div class="input-group input-group-sm">
            <span class="input-group-text"><i class="fas fa-camera" style="color:#4779d7;"></i></span>
            <input type="url" class="form-control" id="photoUrl" name="photoUrl"
                   [(ngModel)]="register.photoUrl" placeholder="https://exemple.com/photo.jpg">
          </div>
        </div>

        <!-- Pays -->
        <div class="mb-2">
          <label for="country" class="form-label">Pays *</label>
          <div class="input-group input-group-sm">
            <span class="input-group-text"><i class="fas fa-globe" style="color:#4779d7;"></i></span>
            <select class="form-control" id="country" name="country"
                    [(ngModel)]="register.country" required #country="ngModel">
              <option value="">Sélectionnez votre pays</option>
              <option value="Senegal">Sénégal</option>
              <option value="Mali">Mali</option>
              <option value="Burkina Faso">Burkina Faso</option>
              <option value="Côte d'Ivoire">Côte d'Ivoire</option>
              <option value="Guinea">Guinée</option>
            </select>
          </div>
          <div *ngIf="country.invalid && country.touched" class="text-danger small">
            Le pays est obligatoire
          </div>
        </div>

      <!-- Mot de passe -->
<!-- Mot de passe -->
<div class="mb-3 position-relative">
  <label for="password" class="form-label">Mot de passe *</label>
  <div class="input-group input-group-sm">
    <span class="input-group-text">
      <i class="fas fa-lock" style="color:#4779d7;"></i>
    </span>
    <input 
      [type]="showPassword ? 'text' : 'password'" 
      class="form-control" 
      id="password" 
      name="password"
      [(ngModel)]="register.password" 
      placeholder="Au moins 6 caractères"
      required 
      minlength="6" 
      #password="ngModel">
    <!-- Icône oeil intégrée -->
    <span 
      class="input-group-text toggle-password" 
      (click)="showPassword = !showPassword" 
      style="cursor: pointer; background: transparent; border-left: none;">
      <i class="fas" [ngClass]="showPassword ? 'fa-eye-slash text-primary' : 'fa-eye text-muted'"></i>
    </span>
  </div>
  <div *ngIf="password.invalid && password.touched" class="text-danger small mt-1">
    <span *ngIf="password.errors?.['required']">Le mot de passe est obligatoire</span>
    <span *ngIf="password.errors?.['minlength']">Doit contenir au moins 6 caractères</span>
  </div>
</div>



        <!-- Bouton s'inscrire -->
        <button type="submit" class="btn btn-primary w-100 btn-sm" [disabled]="registerForm.invalid || isLoading"
                style="background: linear-gradient(135deg, #4779d7, #2569df);">
          <span *ngIf="isLoading" class="spinner-border spinner-border-sm me-2"></span>
          <i class="fas fa-user-plus" *ngIf="!isLoading"></i> 
          {{ isLoading ? 'Création en cours...' : 'Créer mon compte' }}
        </button>
      </form>

      <!-- Lien vers connexion -->
      <div class="text-center mt-3">
        <p>
          Déjà un compte ? 
          <a [routerLink]="'/login'" class="text-primary">
            <i class="fas fa-sign-in-alt"></i> Se connecter
          </a>
        </p>
      </div>

    </div>
  </div>
</div>
